<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <link rel="icon" type="image/png" href="logo.png">
    <meta charset="UTF-8">
    <title>机箱温度控制台</title>
    <link rel="stylesheet" type="text/css" href="main.css">
</head>

<body>
    <div class="button_div">
        <center>
            <div>
                <h1> 当前温度： <span id="Temperature">正在读取</span></h1>
            </div>
            <div>
                <h1>当前模式： <span id="Condition">正在读取</span></h1>
            </div>
            <div>
                <h1>当前状态： <span id="fanStatus">正在读取</span></h1>
            </div>
            <div>
                <h1>最大温度： <span id="Temperature_MAX">正在读取</span></h1>
            </div>
            <div>
                <form action="fan" method="post">
                    <h1> <span class="mytxt">设定最大温度：</span>
                        <input type="text" value="" name="max_t"> </h1>
                    </br>
                    <input class="button" type="submit" value="open" name="status">
                    <input class="button" type="submit" value="close" name="status">
                    <input class="button" type="submit" value="auto" name="status">
                </form>
            </div>
            <script>
                setInterval(function() {
                    // Call a function repetatively with 1 Second interval
                    getData();
                    getCondition();
                    getTemperature_MAX();
                    getfanStatus();
                }, 1000); //1000mSeconds update rate

                function getData() {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            document.getElementById("Temperature").innerHTML = this.responseText;
                        }
                    };
                    xhttp.open("GET", "temperature", true);
                    xhttp.send();

                }

                function getCondition() {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            document.getElementById("Condition").innerHTML = this.responseText;
                        }
                    };
                    xhttp.open("GET", "Condition", true);
                    xhttp.send();
                }


                function getTemperature_MAX() {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            document.getElementById("Temperature_MAX").innerHTML = this.responseText;
                        }
                    };
                    xhttp.open("GET", "Temperature_MAX", true);
                    xhttp.send();
                }

                function getfanStatus() {
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            document.getElementById("fanStatus").innerHTML = this.responseText;
                        }
                    };
                    xhttp.open("GET", "fanStatus", true);
                    xhttp.send();
                }
            </script>
        </center>
    </div>
</body>

</html>